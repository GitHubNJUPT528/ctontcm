<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no">
    <title>路径规划</title>
    <style>
        html,body{
            height: 100%;
            width: 100%;
            overflow:hidden;
            margin:0;
            font-family: "微软雅黑";
        }
    </style>
    <script type="text/javascript" src="../JQuery/jquery-1.7.2.js"></script>
    <script src="http://api.map.baidu.com/api?type=webgl&v=1.0&ak=9iAk4XnzsGNHk2VZP75CiaoR0R7oCt05"></script>
</head>
<body>

<div id="stationList" class="stationList" style="height:100%;overflow:auto; float:left">
    <ul id="leftStationUl" class="leftStationUl">
        <li id="stationLi_250124" onclick="showInfoWin250124(1)" onmouseover="limouseover(this, 250124)" onmouseout="limouseout(this, 250124)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                    <b>江苏省南京市栖霞区迈皋桥分公司</b>
                    </dt>
                    <dd>地址：南京市栖霞区合班村130号</dd>
                    <dd>客服电话：17361807295</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250133" onclick="showInfoWin250133(1)" onmouseover="limouseover(this, 250133)" onmouseout="limouseout(this, 250133)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市建邺区江心洲分公司</b>
                    </dt>
                    <dd>地址：南京市建邺区江心洲星影街32-7</dd>
                    <dd>客服电话：19941503204</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250114" onclick="showInfoWin250114(1)" onmouseover="limouseover(this, 250114)" onmouseout="limouseout(this, 250114)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市鼓楼区广东路分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市鼓楼区东瓜圃桥8号</dd>
                    <dd>客服电话：17512519200</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250049" onclick="showInfoWin250049(1)" onmouseover="limouseover(this, 250049)" onmouseout="limouseout(this, 250049)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市浦口二部分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市浦口区顶山街道顶山创业园...</dd>
                    <dd>客服电话：025-58739908</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250120" onclick="showInfoWin250120(1)" onmouseover="limouseover(this, 250120)" onmouseout="limouseout(this, 250120)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市鼓楼区紫竹林分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市鼓楼区许府巷紫竹林3号</dd>
                    <dd>客服电话：13770577680</dd>
                </dl></a>
        </li>
        <li id="stationLi_250115" onclick="showInfoWin250115(1)" onmouseover="limouseover(this, 250115)" onmouseout="limouseout(this, 250115)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市鼓楼区石头城分公司</b>
                    </dt>
                    <dd>地址：南京市鼓楼区定淮门17号分公司快递</dd>
                    <dd>客服电话：13002570396</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250112" onclick="showInfoWin250112(1)" onmouseover="limouseover(this, 250112)" onmouseout="limouseout(this, 250112)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市鼓楼区虹桥中心分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市鼓楼区虎踞北路100号8...</dd>
                    <dd>客服电话：025-86809283</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250061" onclick="showInfoWin250061(1)" onmouseover="limouseover(this, 250061)" onmouseout="limouseout(this, 250061)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市新河西分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市鼓楼区燕山路118号</dd>
                    <dd>客服电话：18013525870</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250111" onclick="showInfoWin250111(1)" onmouseover="limouseover(this, 250111)" onmouseout="limouseout(this, 250111)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市鼓楼区中山万豪分公司</b>
                    </dt>
                    <dd>地址：江苏省南京市鼓楼区宁海路街道祁家桥1...</dd>
                    <dd>客服电话：13813906598</dd>
                </dl>
            </a>
        </li>
        <li id="stationLi_250135" onclick="showInfoWin250135(1)" onmouseover="limouseover(this, 250135)" onmouseout="limouseout(this, 250135)" style="height: 94px; border-bottom: 1px solid rgb(178, 178, 176); background-color: rgb(255, 255, 255); cursor: pointer;">
            <a>
                <dl>
                    <dt>
                        <b>江苏省南京市雨花区共青团路分公司</b>
                    </dt>
                    <dd>地址：南京市雨花台区花神庙十号花神科技园三...</dd>
                    <dd>客服电话：025-85381131</dd>
                </dl>
            </a>
        </li>
    </ul>
</div>
<div id="container" style="height:100%; position: relative; overflow: hidden; z-index: 0; background-color: rgb(243, 241, 236); color: rgb(0, 0, 0); text-align: left;">
</div>






<script type="text/javascript">
    var map = new BMapGL.Map("container");
    map.centerAndZoom('南京市',12);
    map.enableScrollWheelZoom(true);
    var makerList = [];
    // 江苏省区南京转运中心
    var p0 = new BMapGL.Point(118.81611,31.777821);
    // 栖霞区迈皋桥分公司
    var p250124= new BMapGL.Point(118.821565,32.114319);
    // 江心洲分公司
    var p250133= new BMapGL.Point(118.716898,32.048265);
    // 广东路分公司
    var p250114= new BMapGL.Point(118.771426,32.088295);
    // 浦口二部分公司
    var p250049= new BMapGL.Point(118.680943,32.11551);
    // 紫竹林分公司
    var p250120= new BMapGL.Point(118.780865,32.090088);
    // 石头城分公司
    var p250115= new BMapGL.Point(118.757481,32.074374);
    // 虹桥中心分公司
    var p250112= new BMapGL.Point(118.76091,32.085629);
    // 新河西分公司
    var p250061= new BMapGL.Point(118.739278,32.030876);
    // 中山万豪分公司
    var p250111= new BMapGL.Point(118.773292,32.078233);
    // 共青团路分公司
    var p250135= new BMapGL.Point(118.774808,31.992572);

    var arrayList = [] ;
    arrayList.push(p250124);arrayList.push(p250133);arrayList.push(p250114);arrayList.push(p250049);arrayList.push(p250120);arrayList.push(p250115);arrayList.push(p250112);arrayList.push(p250061);
    arrayList.push(p250111);arrayList.push(p250135);
    ;

    function showInfoWin250124(flag) {
        var stationLi_250124 = $("#stationLi_250124 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250124 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
        map.openInfoWindow(infoWindow, p250124); //开启信息窗口
    }
    function showInfoWin250133(flag) {
        var stationLi_250133 = $("#stationLi_250133 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250133 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250133); //开启信息窗口
    }
    function showInfoWin250114(flag) {
        var stationLi_250114 = $("#stationLi_250114 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250114 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250114); //开启信息窗口
    }
    function showInfoWin250049(flag) {
        var stationLi_250049 = $("#stationLi_250049 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250049 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250049); //开启信息窗口
    }
    function showInfoWin250120(flag) {
        var stationLi_250120 = $("#stationLi_250120 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250120 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250120); //开启信息窗口
    }
    function showInfoWin250115(flag) {
        var stationLi_250115 = $("#stationLi_250115 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250115 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250115); //开启信息窗口
    }
    function showInfoWin250112(flag) {
        var stationLi_250112 = $("#stationLi_250112 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250112 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250112); //开启信息窗口
    }
    function showInfoWin250061(flag) {
        var stationLi_250061 = $("#stationLi_250061 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250061 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250061); //开启信息窗口
    }
    function showInfoWin250111(flag) {
        var stationLi_250111 = $("#stationLi_250111 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250111 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250111); //开启信息窗口
    }
    function showInfoWin250135(flag) {
        var stationLi_250135 = $("#stationLi_250135 a dl dt b").text();
        var opts = {
            width : 500,     // 信息窗口宽度
            height: 50,     // 信息窗口高度
            title : stationLi_250135 , // 信息窗口标题
            message:""
        }
        var expressTotal = Math.floor(Math.random()*10000);
        var infoWindow = new BMapGL.InfoWindow("待派送件数:"+expressTotal, opts);  // 创建信息窗口对象
        //listItem的点击
        if(flag = 1)
            map.openInfoWindow(infoWindow, p250135); //开启信息窗口
    }


    function showPoly(pointList){

        //循环显示点对象
        for(let c=0;c<pointList.length;c++){
            makerList[c] = new BMapGL.Marker(pointList[c]);
            map.addOverlay(makerList[c]);
            makerList[c].addEventListener("click",function(){
                if(makerList[c] = p250124)
                {
                    showInfoWin250124(1);
                    map.openInfoWindow(infoWindow, p250124); //开启信息窗口
                }
                else if (makerList[c] = p250049)
                {
                    showInfoWin250049(1);
                    map.openInfoWindow(infoWindow, p250049); //开启信息窗口
                }
                else if (makerList[c] = p250061)
                {
                    showInfoWin250061(0);
                    map.openInfoWindow(infoWindow, p250061); //开启信息窗口
                }
                else if (makerList[c] = p250111)
                {
                    showInfoWin250111(0);
                    map.openInfoWindow(infoWindow, p250111); //开启信息窗口
                }
                else if (makerList[c] = p250112)
                {
                    showInfoWin250112(0);
                    map.openInfoWindow(infoWindow, p250112); //开启信息窗口
                }
                else if (makerList[c] = p250114)
                {
                    showInfoWin250114(0);
                    map.openInfoWindow(infoWindow, p250114); //开启信息窗口
                }
                else if (makerList[c] = p250115)
                {
                    showInfoWin250115(0);
                    map.openInfoWindow(infoWindow, p250115); //开启信息窗口
                }
                else if (makerList[c] = p250120)
                {
                    showInfoWin250120(0);
                    map.openInfoWindow(infoWindow, p250120); //开启信息窗口
                }
                else if (makerList[c] = p250133)
                {
                    showInfoWin250133(0);
                    map.openInfoWindow(infoWindow, p250133); //开启信息窗口
                }
                else if (makerList[c] = p250135)
                {
                    showInfoWin250135(0);
                    map.openInfoWindow(infoWindow, p250135); //开启信息窗口
                }

            });
            //将途经点按顺序添加到地图上
            var label = new BMapGL.Label(c+1,{offset:new BMapGL.Size(20,-10)});
            makerList[c].setLabel(label);
        }

        var  group = Math.floor( pointList.length /11 ) ;
        var mode = pointList.length %11 ;

        var driving = new BMapGL.DrivingRoute( map, {onSearchComplete: function(results){
                if (driving.getStatus() == BMAP_STATUS_SUCCESS){
                    var plan = driving.getResults().getPlan(0);
                    var  num = plan.getNumRoutes();
                    for(var j =0;j<num ;j++){
                        var pts= plan.getRoute(j).getPath();    //通过驾车实例，获得一系列点的数组
                        var polyline = new BMapGL.Polyline(pts);
                        map.addOverlay(polyline);
                    }
                }
            }});
        for(var i =0;i<group;i++){
            var waypoints = pointList.slice(i*11+1,(i+1)*11);
            //注意这里的终点如果是11的倍数的时候，数组可是取不到最后一位的，所以要注意终点-1喔。感谢song141的提醒，怪我太粗心大意了~
            driving.search(pointList[i*11], pointList[(i+1)*11-1],{waypoints:waypoints});//waypoints表示途经点
        }
        if( mode != 0){
            var waypoints = pointList.slice(group*11,pointList.length-1);//多出的一段单独进行search
            driving.search(pointList[group*11],pointList[pointList.length-1],{waypoints:waypoints});
        }

    }
    showPoly(arrayList);

</script>
</body>
</html>
